# Evaluation-related

## Description
This folder contains all the raw data and code files of the experiments for the artifact submission.

- The `/Data` folder includes all the raw magnetic field readings of three key experiments, saved in CSV format. Each experiment consists of ten sets of data.

- The `/Code` folder contains:
    
    - `sensing_offline.py`: 
    the offline version of the sensing algorithm, which provides quick detection results.
    - `/Utils` folder: 
    contains required utility functions for the sensing pipeline.
    - `template_36_5_80.txt`: 
    this template is generated by synthesizing magnetometer data during the offline stage using Magpylib. 
    It is used to determine the relative orientation of the sensor array with respect to the magnet by DDTW matching process. 
    For more details, please refer to Sec. 6.2.2 of the paper.

- The `/Results` folder contains the processed results for all data, including the estimated heading angle, localization accuracy, tag encoding information, etc.

## How to run
Since the real-time operation of Polaris requires hardware (such as a sensor array), to allow evaluators to quickly get started with our Polaris system, we have provided an offline version of the sensing algorithm framework, `sensing_offline.py`. 
This code reads offline magnetic field data and replicates the results of real-time detection.

To use this code, follow these four simple steps:
- Download our GitHub repository to your local machine.

- Navigate to the `Evaluation/Codes` folder, set up the Python environment, and install the following required libraries:
    - pandas, numpy, datetime, math, ctypes
- Open the `sensing_offline.py` source file, modify `line 598` (the file path to the offline data to be processed) and `line 599` (the file path to save the results) according to your needs. 
    - By default, the code processes the first set of data from the default tag experiment, located at `../Data/Default_Tag/RawData_1.csv`, and saves the results to `../Results/Default_Tag_Exp.txt`.
    ```
    default_tag_file = "../Data/Default_Tag/RawData_1.csv"
    result_txt = "../Results/Default_Tag_Exp.txt"
    ```

- Run the code, and the terminal will display similar information as follows:
    ```
    Begin detecting at 2024-09-10 22:54:56.756350                                           
    Initialize the threshold
    sensor 4: Pre-done with slope threshold equaling to 0.51
    sensor 9: Pre-done with slope threshold equaling to 0.65
    sensor 1: Pre-done with slope threshold equaling to 0.41
    sensor 5: Pre-done with slope threshold equaling to 0.43
    sensor 6: Pre-done with slope threshold equaling to 0.58
    sensor 7: Pre-done with slope threshold equaling to 0.53
    sensor 3: Pre-done with slope threshold equaling to 0.49
    sensor 2: Pre-done with slope threshold equaling to 0.83
    sensor 8: Pre-done with slope threshold equaling to 0.47
    Begin detecting process
    Estimated heading angle: -1.2241516388127511 deg
    The localization error is: 1.4210664527053516 mm
    The decoded bits are: ['111', '111', '111', '111', '111', '111']
    The corresponding tag id is: 262143
    End detection
    ```
